<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>


<script>
    function Observer(data) {
        this.data = data;
        this.walk(data);
    }
    
    Observer.prototype.walk = function (obj) {
        var val;
        for(var key in obj){
            if(obj.hasOwnProperty(key)){
                val = obj[key];
                if(typeof val === "object"){
                    new Observer(val);
                }
                this.convert(key,val);
            }
        }
    };

    Observer.prototype.convert = function (key,val) {
        Object.defineProperty(this.data,key,{
            enumerable: true,
            configurable: true,
            get: function () {
                console.log('你访问了' + key);
                return val;
            },
            set: function (newVal) {
                if (newVal === val) return;
                val = newVal;
                if(typeof newVal === "object"){
                    new Observer(newVal);
                }else{
//                    self.$emit(key);
                    console.log("你设置了" + key + ", 新的值为" + newVal)
                }
            }
        })

    };



    var app2 = new Observer({
        name: {
            firstName: 'shaofeng',
            lastName: 'liang'
        },
        age: 25
    });

//    app2.$watch('name', function (newName) {
//        console.log('我的姓名发生了变化，可能是姓氏变了，也可能是名字变了。')
//    });

//    app2.data.name.firstName = 'hahaha';
    // 输出：我的姓名发生了变化，可能是姓氏变了，也可能是名字变了。
//    app2.data.name.lastName = 'blablabla';
    // 输出：我的姓名发生了变化，可能是姓氏变了，也可能是名字变了。
</script>
</body>
</html>